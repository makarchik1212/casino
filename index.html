<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Dropnado | Кейс-казино</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('https://cdn.cloudflare.steamstatic.com/apps/csgo/images/dust2_overview.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
    }

    header {
      background: rgba(0, 0, 0, 0.85);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #00ffff;
    }

    header h1 {
      color: #00ffff;
      font-size: 32px;
      margin: 0;
    }

    .balance {
      font-size: 20px;
      color: #ffd700;
    }

    main {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      background: rgba(0,0,0,0.7);
    }

    section {
      background: rgba(20, 20, 20, 0.85);
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 15px rgba(0,255,255,0.2);
    }

    h2 {
      margin-top: 0;
      border-bottom: 1px solid #00ffff;
      padding-bottom: 5px;
    }

    .case-list button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(45deg, #00ffff, #007fff);
      color: #000;
      border: none;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .case-list button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #00ffffaa;
    }

    .inventory-item {
      background: #1e1e1e;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 8px;
      border-left: 4px solid #ffd700;
    }

    .contract-item {
      padding: 10px;
      background: #2a2a2a;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
      border: 2px solid transparent;
      transition: border-color 0.2s ease;
    }

    .contract-item.selected {
      border-color: #00ffff;
    }

    #make-contract, .upgrader button, .promo button {
      padding: 12px 24px;
      background: #00ffff;
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    #make-contract:hover, .upgrader button:hover, .promo button:hover {
      background: #00dddd;
    }

    .upgrader input, .promo input {
      padding: 10px;
      margin-right: 10px;
      border-radius: 6px;
      border: none;
    }

    #drop-animation {
      width: 100%;
      overflow: hidden;
      background: #000;
      border: 2px solid #00ffff;
      border-radius: 10px;
      margin-top: 20px;
      height: 100px;
      position: relative;
    }

    #drop-strip {
      display: flex;
      width: 10000px;
      animation: scroll 3s linear forwards;
    }

    .drop-item {
      width: 100px;
      height: 100px;
      background: #1a1a1a;
      margin-right: 10px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: #fff;
      border: 2px solid transparent;
    }

    @keyframes scroll {
      from { transform: translateX(0); }
      to { transform: translateX(-1000px); }
    }
  </style>
</head>
<body>
  <header>
    <h1>Dropnado</h1>
    <div class="balance">Баланс: <span id="balance">1000</span>$</div>
  </header>

  <main>
    <section class="case-list">
      <h2>Выбор кейса</h2>
      <button onclick="openCase('Desert Case', 100)">Desert Case – $100</button>
      <button onclick="openCase('Night Storm', 200)">Night Storm – $200</button>
      <button onclick="openCase('Ultra Rare', 500)">Ultra Rare – $500</button>
      <div id="drop-animation"><div id="drop-strip"></div></div>
    </section>

    <section class="inventory">
      <h2>Инвентарь</h2>
      <ul id="inventory-list"></ul>
    </section>

    <section class="contracts">
      <h2>Контракты</h2>
      <p>Выберите 3–10 предметов</p>
      <ul id="contract-list"></ul>
      <button id="make-contract" disabled>Создать контракт</button>
    </section>

    <section class="upgrader">
      <h2>Апгрейд</h2>
      <input type="number" id="upgrade-id" placeholder="ID предмета">
      <input type="number" id="target-price" placeholder="Цена цели ($)">
      <button onclick="tryUpgrade()">Апгрейд</button>
    </section>

    <section class="promo">
      <h2>Промокод</h2>
      <input type="text" id="promo-code" placeholder="Введите промокод">
      <button onclick="redeemPromo()">Активировать</button>
    </section>
  </main>

  <script>
    let balance = 1000;
    let inventory = [];
    let usedPromo = false;

    const skins = [
      { name: "AK-47 | Redline", price: 120 },
      { name: "M4A4 | Howl", price: 300 },
      { name: "AWP | Asiimov", price: 200 },
      { name: "Glock-18 | Fade", price: 180 },
      { name: "Karambit | Doppler", price: 600 },
      { name: "USP-S | Kill Confirmed", price: 150 },
      { name: "Desert Eagle | Blaze", price: 250 }
    ];

    function updateBalance() {
      document.getElementById("balance").textContent = balance;
    }

    function updateInventory() {
      const list = document.getElementById("inventory-list");
      list.innerHTML = '';
      inventory.forEach((item, index) => {
        const el = document.createElement('li');
        el.className = 'inventory-item';
        el.textContent = `#${index} - ${item.name} – $${item.price}`;
        list.appendChild(el);
      });
    }

    function getRandomSkin() {
      return skins[Math.floor(Math.random() * skins.length)];
    }

    function openCase(caseName, casePrice) {
      if (balance < casePrice) {
        alert("Недостаточно средств!");
        return;
      }

      const strip = document.getElementById('drop-strip');
      strip.innerHTML = '';

      for (let i = 0; i < 30; i++) {
        const skin = getRandomSkin();
        const el = document.createElement('div');
        el.className = 'drop-item';
        el.textContent = skin.name;
        strip.appendChild(el);
      }

      setTimeout(() => {
        const drop = getRandomSkin();
        inventory.push(drop);
        balance -= casePrice;
        alert(`Ты получил: ${drop.name} – $${drop.price}`);
        updateBalance();
        updateInventory();
        updateContractList();
      }, 3000);
    }

    const contractList = document.getElementById('contract-list');
    const makeContractBtn = document.getElementById('make-contract');
    let selectedForContract = [];

    function updateContractList() {
      contractList.innerHTML = '';
      inventory.forEach((item, index) => {
        const el = document.createElement('div');
        el.className = 'contract-item';
        el.textContent = `${item.name} ($${item.price})`;
        el.onclick = () => toggleContractItem(index, el);
        if (selectedForContract.includes(index)) el.classList.add('selected');
        contractList.appendChild(el);
      });
      makeContractBtn.disabled = selectedForContract.length < 3 || selectedForContract.length > 10;
    }

    function toggleContractItem(index, el) {
      if (selectedForContract.includes(index)) {
        selectedForContract = selectedForContract.filter(i => i !== index);
        el.classList.remove('selected');
      } else {
        selectedForContract.push(index);
        el.classList.add('selected');
      }
      makeContractBtn.disabled = selectedForContract.length < 3 || selectedForContract.length > 10;
    }

    makeContractBtn.addEventListener('click', () => {
      const selectedItems = selectedForContract.map(i => inventory[i]);
      const totalValue = selectedItems.reduce((sum, item) => sum + item.price, 0);
      const newItemPrice = Math.floor(totalValue * (0.8 + Math.random() * 0.4));
      const newItemName = "Контрактный дроп $" + newItemPrice;

      inventory = inventory.filter((_, idx) => !selectedForContract.includes(idx));
      inventory.push({ name: newItemName, price: newItemPrice });

      selectedForContract = [];
      updateBalance();
      updateInventory();
      updateContractList();

      alert(`Ты получил: ${newItemName}`);
    });

    function tryUpgrade() {
      const id = parseInt(document.getElementById('upgrade-id').value);
      const target = parseInt(document.getElementById('target-price').value);
      if (isNaN(id) || isNaN(target) || !inventory[id]) return alert('Неверный ввод.');

      const current = inventory[id];
      const chance = Math.min(100, Math.floor((current.price / target) * 100));
      const success = Math.random() * 100 <= chance;

      if (success) {
        inventory[id] = { name: `Апгрейд $${target}`, price: target };
        alert(`Успешный апгрейд до $${target} (${chance}%)!`);
      } else {
        inventory.splice(id, 1);
        alert(`Провал. Ты потерял ${current.name} (${chance}%)`);
      }

      updateInventory();
      updateContractList();
    }

    function redeemPromo() {
      if (usedPromo) return alert("Промокод уже активирован!");
      const code = document.getElementById('promo-code').value.trim().toLowerCase();
      if (code === "dropnado") {
        balance += 500;
        usedPromo = true;
        alert("Промокод активирован! +$500 на баланс");
        updateBalance();
      } else {
        alert("Неверный промокод!");
      }
    }

    updateBalance();
    updateInventory();
    updateContractList();
  </script>
</body>
</html>
